# GGUKï¼ˆê¾¹ï¼‰

**æ„Ÿæƒ…ã‚’â€œæŠ¼ã—è¾¼ã‚ã¦â€è¨˜éŒ²ã™ã‚‹ iOS ç¿’æ…£ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã‚¢ãƒ—ãƒª**

---

## ğŸ“± ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç´¹ä»‹

**GGUK** ã¯ã€æ—¥å¸¸ã§æ„Ÿã˜ã‚‹æ€’ã‚Šã‚„ã‚¹ãƒˆãƒ¬ã‚¹ã‚’

**ã€Œæˆ‘æ…¢ã—ãŸå›æ•°ã€ã¨ã„ã†ã‚·ãƒ³ãƒ—ãƒ«ãªè¡Œå‹•è¨˜éŒ²**ã¸ã¨å¤‰æ›ã™ã‚‹

iOS ãƒˆã‚¤ã‚¢ãƒ—ãƒªã§ã™ã€‚

ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã„ã†è¡Œç‚ºã‚’é€šã˜ã¦æ„Ÿæƒ…ã‚’å³åº§ã«ç™ºæ•£ã—ã€

è“„ç©ã•ã‚ŒãŸè¨˜éŒ²ã«ã‚ˆã£ã¦

**è‡ªåˆ†è‡ªèº«ã®å¿è€ã‚’è¦–è¦šçš„ã«èªè­˜ã§ãã‚‹**ã‚ˆã†è¨­è¨ˆã—ã¾ã—ãŸã€‚

---

## ğŸ§­ ã‚¢ãƒ—ãƒªã®æ€§æ ¼ / ç›®çš„

- iOS ãƒˆã‚¤ã‚¢ãƒ—ãƒªï¼ˆæ„Ÿæƒ… / ç¿’æ…£è¨˜éŒ²ï¼‰
- **æŠ€è¡“å­¦ç¿’ã‚’ç›®çš„ã¨ã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**
- UI æ§‹æˆã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã€èªè¨¼å‡¦ç†ã¾ã§
    
    **å®Ÿã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆã‚’è»½ãä½“é¨“ã™ã‚‹ã“ã¨**ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™
    

---

## ğŸ›  æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### iOS / UI

- **UIKit**
- **SnapKit**
    
    â†’ ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã§ AutoLayout ã‚’æ§‹ç¯‰
    
    â†’ ã™ã¹ã¦ã®ç”»é¢ã‚’ Storyboard ãªã—ã§å®Ÿè£…
    

### Reactive / Data Flow

- **RxSwift / RxCocoa**
    - ãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ—ã‚¤ãƒ™ãƒ³ãƒˆã®å‡¦ç†
    - UI çŠ¶æ…‹ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆ`BehaviorRelay`ï¼‰
    - View â†” çŠ¶æ…‹ã®æµã‚Œã‚’å®£è¨€çš„ã«æ§‹æˆ

### Local Persistence

- **Realm**
    - ãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ—å›æ•°ã®ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜
    - ã‚¢ãƒ—ãƒªçµ‚äº† / å†èµ·å‹•å¾Œã‚‚çŠ¶æ…‹ã‚’ä¿æŒ
    - Singleton å½¢å¼ã®ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’æ§‹æˆ

### Backend / Auth

- **Supabase**
    - Email / Password ãƒ­ã‚°ã‚¤ãƒ³
    - Apple OAuth ãƒ­ã‚°ã‚¤ãƒ³
    - ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ™ãƒ¼ã‚¹ã®è‡ªå‹•ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†
    - ãƒ¦ãƒ¼ã‚¶ãƒ¼é‡è¤‡ãƒã‚§ãƒƒã‚¯ï¼ˆusers ãƒ†ãƒ¼ãƒ–ãƒ«å‚ç…§ï¼‰

### Async / Concurrency

- **Swift Concurrencyï¼ˆ`async / await`ï¼‰**
    - Supabase Auth / DB å‘¼ã³å‡ºã—
    - ãƒ­ã‚°ã‚¤ãƒ³ã€ä¼šå“¡ç™»éŒ²ã€ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒ•ãƒ­ãƒ¼ã®éåŒæœŸå‡¦ç†

---

## ğŸ§© ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### åŸºæœ¬æ§‹æˆ

- **UIKit + MVVM**
- ViewController ã¯ UI ã¨ã‚¤ãƒ™ãƒ³ãƒˆä¼é”ã‚’æ‹…å½“
- ViewModel ã¯ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¨ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã‚’æ‹…å½“

```
ViewController
 â””â”€ ViewModel
     â””â”€ SupabaseManager / RealmFunc

```

### ç‰¹å¾´

- ç”»é¢å˜ä½ã§ ViewModel ã‚’åˆ†é›¢
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ / ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜ãƒ­ã‚¸ãƒƒã‚¯ã‚’ VC ã‹ã‚‰åˆ†é›¢

---

## ğŸ” èªè¨¼ & ã‚¢ãƒ—ãƒªãƒ•ãƒ­ãƒ¼

### ã‚¢ãƒ—ãƒªèµ·å‹•ãƒ•ãƒ­ãƒ¼

1. `SplashVC`
2. Supabase ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æœ‰åŠ¹æ€§ãƒã‚§ãƒƒã‚¯
3. ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã«å¿œã˜ã¦ Root ã‚’åˆ‡ã‚Šæ›¿ãˆ
    - ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ â†’ Main
    - æœªãƒ­ã‚°ã‚¤ãƒ³ â†’ SignIn

### Root åˆ‡ã‚Šæ›¿ãˆ

- `AppRouter` ã«ã‚ˆã‚‹ **RootViewController ã®å·®ã—æ›¿ãˆ**
- ãƒ­ã‚°ã‚¤ãƒ³ / ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ™‚ã«ç”»é¢ã‚¹ã‚¿ãƒƒã‚¯ã‚’åˆæœŸåŒ–

---

## ğŸ”„ RxSwift é©ç”¨ä¾‹

- ãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ— â†’ çŠ¶æ…‹å¢—åŠ 
- çŠ¶æ…‹å¤‰åŒ– â†’ UI ã«è‡ªå‹•åæ˜ 

```swift
touchButton.rx.tap
    .withLatestFrom(countRelay)
    .map {$0+1 }
    .bind(to: countRelay)

```

- UI ã‚¤ãƒ™ãƒ³ãƒˆã€çŠ¶æ…‹ã€ä¿å­˜ãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ†é›¢ã—ã€
    
    **ã€Œã‚¤ãƒ™ãƒ³ãƒˆ â†’ çŠ¶æ…‹ â†’ è¡¨ç¾ã€** ã®æµã‚Œã‚’æ˜ç¢ºåŒ–
    

---

## ğŸ’¾ Realm ä½¿ç”¨æ„å›³

- ã‚·ãƒ³ãƒ—ãƒ«ãªç´¯ç©ãƒ‡ãƒ¼ã‚¿ã§ã‚ã£ã¦ã‚‚
    - ã‚¢ãƒ—ãƒªçµ‚äº†å¾Œã‚‚ä¿æŒ
    - ä»–ç”»é¢ï¼ˆçµ±è¨ˆï¼‰ã§å†åˆ©ç”¨
- Realm ã‚’é€šã˜ã¦
    - ãƒ­ãƒ¼ã‚«ãƒ« DB ãƒ¢ãƒ‡ãƒ«å®šç¾©
    - ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ç®¡ç†ã®ãƒ¡ãƒªãƒƒãƒˆ / ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’ä½“æ„Ÿ

---

## ğŸš¨ å•é¡ŒçŠ¶æ³ãŠã‚ˆã³è§£æ±º

### ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ‡ã‚Šæ›¿ãˆæ™‚ã« Realm ãƒ‡ãƒ¼ã‚¿ãŒä¿æŒã•ã‚Œã‚‹å•é¡Œ

ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå¾Œã«åˆ¥ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§å†ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸéš›ã€

å‰ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜ãƒ‡ãƒ¼ã‚¿ãŒãã®ã¾ã¾è¡¨ç¤ºã•ã‚Œã‚‹å•é¡ŒãŒç™ºç”Ÿã—ãŸã€‚

ã“ã‚Œã¯ Realm ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å˜ä¸€ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`default.realm`ï¼‰ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€

ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æ¦‚å¿µã¨ã¯ç„¡é–¢ä¿‚ã«åŒä¸€ã®ãƒ­ãƒ¼ã‚«ãƒ« DB ã‚’å‚ç…§ã—ã¦ã„ãŸã“ã¨ãŒåŸå› ã§ã‚ã‚‹ã€‚

---

### ğŸ” è§£æ±ºã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã”ã¨ã®ãƒ‡ãƒ¼ã‚¿åˆ†é›¢ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ã‚ˆã†ã«æ§‹é€ ã‚’æ”¹å–„ã—ãŸã€‚

- Supabase ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸæ™‚ã« `userId` ã‚’å–å¾—
- `userId` ã‚’åŸºã« Realm ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’å‹•çš„ã«è¨­å®š
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ‡ã‚Šæ›¿ãˆæ™‚ã«è©²å½“ `userId` ã«å¯¾å¿œã™ã‚‹ Realm ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å†ç”Ÿæˆ

---

### ğŸ§© ä¿®æ­£å†…å®¹

### 1ï¸âƒ£ Realm ãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ†é›¢ï¼ˆRealmManager.swiftï¼‰

```swift
private func makeConfiguration(for userId: String) -> Realm.Configuration {
    var config = Realm.Configuration.defaultConfiguration
    config.fileURL = baseURL.appendingPathComponent("realm_\(userId).realm")
    return config
}
```

---

### 2ï¸âƒ£ ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸæ™‚ã« Realm ã‚’åˆ‡ã‚Šæ›¿ãˆï¼ˆSignInVM.swiftï¼‰

```swift
let userId = try await SupabaseManager.shared.currentUserId()
try RealmManager.shared.switchUser(userId: userId)
```

---

### 3ï¸âƒ£ ã‚³ãƒ¼ãƒ‰å¤‰æ›´ â‘ ï¼ˆRealm.swiftï¼‰

```swift
// Before
let realm = try! Realm()

// After
let realm = try! RealmManager.shared.current()
```

---

### 4ï¸âƒ£ ã‚³ãƒ¼ãƒ‰å¤‰æ›´ â‘¡ï¼ˆSplashVM.swiftï¼‰

```swift
let loggedIn = await SupabaseManager.shared.hasValidSession()

if loggedIn {
    if let userId = try? await SupabaseManager.shared.currentUserId() {
        try? RealmManager.shared.switchUser(userId: userId)
    }
    return .main
}
```

---

### âœ… çµæœ

- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ A â†’ `realm_A_userId.realm`
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ B â†’ `realm_B_userId.realm`

ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã”ã¨ã«ç‹¬ç«‹ã—ãŸãƒ­ãƒ¼ã‚«ãƒ« DB ã‚’æ§‹æˆã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ãŒæ··åœ¨ã™ã‚‹å•é¡Œã‚’è§£æ¶ˆã—ãŸã€‚

---

## âœ¨ å­¦ã‚“ã ã“ã¨ / æŒ¯ã‚Šè¿”ã‚Š

- RxSwift ã‚’å˜ãªã‚‹æ–‡æ³•ã§ã¯ãªã
    
    **çŠ¶æ…‹ãƒ•ãƒ­ãƒ¼ã®è¦³ç‚¹**ã§ç†è§£ã§ããŸ
    
- ViewController ã®è‚¥å¤§åŒ–å•é¡Œã‚’
    
    MVVM åˆ†é›¢ã«ã‚ˆã£ã¦å®Ÿæ„Ÿ
    
- SnapKit ã‚’ç”¨ã„ãŸã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ UI æ§‹ç¯‰ã«ç¿’ç†Ÿ
- Supabase ã‚’é€šã˜ãŸèªè¨¼ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã€OAuth ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®çµŒé¨“
